{"timestamp":"2025-09-19T14:58:28.809139","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-09-19T14:58:28.858974","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/flights_above_me.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-09-19T14:58:38.606824","level":"info","event":"Executing: \n        CREATE TABLE IF NOT EXISTS user_location (\n            location_id SERIAL PRIMARY KEY,\n            name TEXT NOT NULL,\n            lat NUMERIC NOT NULL,\n            lon NUMERIC NOT NULL,\n            radius_km NUMERIC NOT NULL DEFAULT 30\n        );\n        CREATE TABLE IF NOT EXISTS aircraft (\n            icao24 TEXT PRIMARY KEY,\n            manufacturer TEXT,\n            model TEXT,\n            country TEXT,\n            operator TEXT\n        );\n        CREATE TABLE IF NOT EXISTS flights (\n            flight_id TEXT PRIMARY KEY,\n            icao24 TEXT REFERENCES aircraft(icao24),\n            callsign TEXT,\n            dep_airport TEXT,\n            arr_airport TEXT,\n            dep_time TIMESTAMPTZ,\n            arr_time TIMESTAMPTZ,\n            source TEXT DEFAULT 'opensky'\n        );\n        CREATE TABLE IF NOT EXISTS state_vectors (\n            state_id SERIAL PRIMARY KEY,\n            icao24 TEXT,\n            callsign TEXT,\n            lat NUMERIC,\n            lon NUMERIC,\n            altitude NUMERIC,\n            velocity NUMERIC,\n            heading NUMERIC,\n            timestamp TIMESTAMPTZ NOT NULL,\n            raw_json JSONB\n        );\n        CREATE TABLE IF NOT EXISTS nearby_flights (\n            nf_id SERIAL PRIMARY KEY,\n            location_id INT REFERENCES user_location(location_id),\n            icao24 TEXT,\n            flight_id TEXT REFERENCES flights(flight_id),\n            timestamp TIMESTAMPTZ NOT NULL,\n            distance_km NUMERIC,\n            is_overhead BOOLEAN DEFAULT FALSE,\n            metadata JSONB\n        );\n        ","logger":"airflow.task.operators.airflow.providers.common.sql.operators.sql.SQLExecuteQueryOperator"}
{"timestamp":"2025-09-19T14:58:38.660952","level":"info","event":"Secrets backends loaded for worker","count":1,"backend_classes":["EnvironmentVariablesBackend"],"logger":"supervisor"}
{"timestamp":"2025-09-19T14:58:40.434289","level":"info","event":"Connection Retrieved 'postgres'","logger":"airflow.hooks.base"}
{"timestamp":"2025-09-19T14:58:41.039240","level":"info","event":"Secrets backends loaded for worker","count":1,"backend_classes":["EnvironmentVariablesBackend"],"logger":"supervisor"}
{"timestamp":"2025-09-19T14:58:41.164984","level":"info","event":"Connection Retrieved 'postgres'","logger":"airflow.hooks.base"}
{"timestamp":"2025-09-19T14:58:41.478724","level":"info","event":"Running statement: \n        CREATE TABLE IF NOT EXISTS user_location (\n            location_id SERIAL PRIMARY KEY,\n            name TEXT NOT NULL,\n            lat NUMERIC NOT NULL,\n            lon NUMERIC NOT NULL,\n            radius_km NUMERIC NOT NULL DEFAULT 30\n        );\n        CREATE TABLE IF NOT EXISTS aircraft (\n            icao24 TEXT PRIMARY KEY,\n            manufacturer TEXT,\n            model TEXT,\n            country TEXT,\n            operator TEXT\n        );\n        CREATE TABLE IF NOT EXISTS flights (\n            flight_id TEXT PRIMARY KEY,\n            icao24 TEXT REFERENCES aircraft(icao24),\n            callsign TEXT,\n            dep_airport TEXT,\n            arr_airport TEXT,\n            dep_time TIMESTAMPTZ,\n            arr_time TIMESTAMPTZ,\n            source TEXT DEFAULT 'opensky'\n        );\n        CREATE TABLE IF NOT EXISTS state_vectors (\n            state_id SERIAL PRIMARY KEY,\n            icao24 TEXT,\n            callsign TEXT,\n            lat NUMERIC,\n            lon NUMERIC,\n            altitude NUMERIC,\n            velocity NUMERIC,\n            heading NUMERIC,\n            timestamp TIMESTAMPTZ NOT NULL,\n            raw_json JSONB\n        );\n        CREATE TABLE IF NOT EXISTS nearby_flights (\n            nf_id SERIAL PRIMARY KEY,\n            location_id INT REFERENCES user_location(location_id),\n            icao24 TEXT,\n            flight_id TEXT REFERENCES flights(flight_id),\n            timestamp TIMESTAMPTZ NOT NULL,\n            distance_km NUMERIC,\n            is_overhead BOOLEAN DEFAULT FALSE,\n            metadata JSONB\n        );\n        , parameters: None","logger":"airflow.task.hooks.airflow.providers.postgres.hooks.postgres.PostgresHook"}
